# Новостной портал

Стек технологий:

- Symfony/Laravel;
- Composer;
- Git;
- MySql;
- PHP >=7.3;
- PHP-FPM;
- Nginx;
- RabbitMQ;

Задача:

Необходимо реализовать новостной портал, с авторизацией и регистрацией.

Сам портал представляет собой агрегатор, который получает информацию с ресурсов используя API или парсинг сайта донора (
можете выбрать абсолютно любой источник на свой вкус).

Вся полученная информация должна храниться локально в БД, где храниться вся информация: дата и ресурс с которого
получены данные, анонс и текст новости.

Подтверждение регистрации должно быть реализовано посредство ввода кода подтверждения через Telegram, для этого
необходимо создать канал или группу, а так же бота и добавить его в созданные ранее канал/группу. (То есть одноразовые
коды тупо постятся ботом в этот канал, делать массовую рассылку на сторонние номера не надо!)

ВАЖНО! Отправку кодов подтверждения необходимо сделать используя брокер сообщений RabbitMQ. Задача об отправке кода
подтверждения должна попадать в очередь, после чего через бота отправляться в канал/группу.

Необходимо реализовать ПУ (Панель управления), в которой видны пользователи которые успешно зарегистрировались,
пользователи которые хотели зарегистрироваться но не завершили регистрацию, и коды подтверждения отправленные в
Telegram. Так же должен быть виден перечень всех новостей с постраничной навигацией.

После авторизации пользователь видит поле поиска и 10 последних полученных новостей, при вводе текста в поле должен
производится поиск по данным находящимся в БД. Отображение найденных данных осуществляется без перезагрузки страницы.

Дополнительная задача:

Будет большим плюсом реализация следующего функционала использующего технологию COMET (sse или websocket на Ваш выбор).

Имеется 3 события:

- регистрация
- авторизация
- получение новых данных порталом

Все авторизованные пользователи находящиеся на портале должны получить визуальное уведомление о событиях указанных
выше (например, каждый пользователь должен получить сообщение о регистрации или авторизации нового пользователя)

## Импорт новостей

Информацию по новостям выгружается из апи https://newsapi.org/ обращение к апи осуществляется с помощью пакета
jcobhams/newsapi

Параметры в .env

NEWS_API_KEY - ключ для авторизации в апи новостей

Выгрузка новостей осуществляется командой
```
php artisan app:import-news
```

## Авторизация и регистрация

Использован пакет laravel/breeze, подтверждение регистрации через тегерамм бот https://t.me/+6x0ZPuiuAGoyZWUy

## Локальное развертывание

docker-compose.yml

Создание .env файла
```
cp .env.example .env
```


Загрузка vendor папки с зависимостями

```
docker run --rm \
    -u "$(id -u):$(id -g)" \
    -v "$(pwd):/var/www/html" \
    -w /var/www/html \
    laravelsail/php82-composer:latest \
    composer install --ignore-platform-reqs
```

Создание схемы базы данных
```
sail artisan migrate
```

## Продакшен развертывание

compose.prod.yml

Создать и заполнить .env
```
cp .env.example .env
```


Сборка и развертывание проекта
```
make up
```

Создание схемы базы данных
```
make migrate
```
